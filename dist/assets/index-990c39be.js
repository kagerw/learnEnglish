import{r as d,a as be,R as ve}from"./vendor-b1791c80.js";import{U as de,F as ye,A as Ne,B as xe,Z as te,T as ne,R as me,L as we,C as Se,X as Ce,a as ke,b as _e}from"./ui-3f167fae.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))l(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}})();var he={exports:{}},z={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Te=d,Ee=Symbol.for("react.element"),Le=Symbol.for("react.fragment"),Re=Object.prototype.hasOwnProperty,Ae=Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$e={key:!0,ref:!0,__self:!0,__source:!0};function ue(s,t,n){var l,a={},r=null,o=null;n!==void 0&&(r=""+n),t.key!==void 0&&(r=""+t.key),t.ref!==void 0&&(o=t.ref);for(l in t)Re.call(t,l)&&!$e.hasOwnProperty(l)&&(a[l]=t[l]);if(s&&s.defaultProps)for(l in t=s.defaultProps,t)a[l]===void 0&&(a[l]=t[l]);return{$$typeof:Ee,type:s,key:r,ref:o,props:a,_owner:Ae.current}}z.Fragment=Le;z.jsx=ue;z.jsxs=ue;he.exports=z;var e=he.exports,se={},ce=be;se.createRoot=ce.createRoot,se.hydrateRoot=ce.hydrateRoot;const ae=[{english:"abundance",japanese:"豊富、大量",difficulty:"advanced",hint:"a から始まる、たくさんあること",example:"There is an abundance of fresh fruit in the market.",example_jp:"市場には新鮮な果物が豊富にある。"},{english:"collaborate",japanese:"協力する",difficulty:"intermediate",hint:"c から始まる、一緒に働くこと",example:"We need to collaborate with other teams to finish this project.",example_jp:"このプロジェクトを終わらせるために他のチームと協力する必要がある。"},{english:"devastating",japanese:"破壊的な",difficulty:"advanced",hint:"d から始まる、大きな被害を与える",example:"The earthquake had a devastating effect on the city.",example_jp:"地震は街に破壊的な影響を与えた。"},{english:"enhance",japanese:"向上させる",difficulty:"intermediate",hint:"e から始まる、より良くすること",example:"This software will enhance your productivity at work.",example_jp:"このソフトウェアは職場での生産性を向上させるでしょう。"},{english:"fundamental",japanese:"基本的な",difficulty:"intermediate",hint:"f から始まる、土台となる",example:"Understanding grammar is fundamental to learning any language.",example_jp:"文法を理解することはどの言語を学ぶにも基本的なことです。"},{english:"genuine",japanese:"本物の、真の",difficulty:"intermediate",hint:"g から始まる、偽物でない",example:"She showed genuine concern for her friend's wellbeing.",example_jp:"彼女は友人の健康を心から心配していた。"},{english:"hypothesis",japanese:"仮説",difficulty:"advanced",hint:"h から始まる、科学的な推測",example:"The scientist tested his hypothesis through careful experiments.",example_jp:"科学者は慎重な実験を通じて仮説を検証した。"},{english:"inevitable",japanese:"避けられない",difficulty:"advanced",hint:"i から始まる、必ず起こること",example:"Change is inevitable in today's fast-paced world.",example_jp:"今日の急速に変化する世界では変化は避けられない。"},{english:"justify",japanese:"正当化する",difficulty:"intermediate",hint:"j から始まる、理由を説明する",example:"Can you justify spending so much money on this project?",example_jp:"このプロジェクトにそんなにお金をかけることを正当化できますか？"},{english:"knowledge",japanese:"知識",difficulty:"basic",hint:"k から始まる、学んだ情報",example:"His knowledge of history is quite impressive.",example_jp:"彼の歴史の知識はかなり印象的だ。"},{english:"limitation",japanese:"制限",difficulty:"intermediate",hint:"l から始まる、制約すること",example:"Budget limitation forced us to reduce the project scope.",example_jp:"予算の制限により、プロジェクトの範囲を縮小せざるを得なかった。"},{english:"magnificent",japanese:"壮大な",difficulty:"intermediate",hint:"m から始まる、素晴らしく立派な",example:"The view from the mountain top was absolutely magnificent.",example_jp:"山頂からの眺めは本当に壮大だった。"},{english:"negotiate",japanese:"交渉する",difficulty:"intermediate",hint:"n から始まる、話し合いで決める",example:"The union will negotiate with management about salary increases.",example_jp:"組合は給与増額について経営陣と交渉する。"},{english:"opportunity",japanese:"機会",difficulty:"basic",hint:"o から始まる、チャンス",example:"This internship is a great opportunity to gain work experience.",example_jp:"このインターンシップは職務経験を積む絶好の機会だ。"},{english:"perspective",japanese:"視点",difficulty:"intermediate",hint:"p から始まる、物事の見方",example:"Looking at the problem from a different perspective might help.",example_jp:"異なる視点から問題を見ることが役立つかもしれない。"},{english:"quality",japanese:"品質",difficulty:"basic",hint:"q から始まる、物の良さ",example:"The quality of their customer service is excellent.",example_jp:"彼らのカスタマーサービスの品質は素晴らしい。"},{english:"reasonable",japanese:"合理的な",difficulty:"intermediate",hint:"r から始まる、理にかなった",example:"Your request seems reasonable and we can accommodate it.",example_jp:"あなたの要求は合理的に思えるので対応できます。"},{english:"significant",japanese:"重要な",difficulty:"intermediate",hint:"s から始まる、大切な意味がある",example:"There has been a significant improvement in sales this quarter.",example_jp:"今四半期は売上に大きな改善があった。"},{english:"tremendous",japanese:"途方もない",difficulty:"advanced",hint:"t から始まる、とても大きな",example:"The team made a tremendous effort to meet the deadline.",example_jp:"チームは締切に間に合わせるために途方もない努力をした。"},{english:"understand",japanese:"理解する",difficulty:"basic",hint:"u から始まる、意味が分かる",example:"Do you understand the instructions for this assignment?",example_jp:"この課題の指示を理解していますか？"}],Me=()=>{const[s,t]=d.useState(null),[n,l]=d.useState(""),[a,r]=d.useState(0),[o,i]=d.useState(0),[x,m]=d.useState(0),[c,h]=d.useState(0),[f,j]=d.useState(0),[N,w]=d.useState("normal"),[L,u]=d.useState("jp-to-en"),[y,R]=d.useState("writing"),[$,A]=d.useState(null),[O,b]=d.useState(!1),[U,S]=d.useState([]),[C,v]=d.useState(!1),[V,M]=d.useState(!1),[W,D]=d.useState(1),[k,G]=d.useState(0),[J,H]=d.useState(10),[Z,P]=d.useState([]),[K,F]=d.useState(null),[X,I]=d.useState([]),[Q,q]=d.useState(ae);return{currentQuestion:s,setCurrentQuestion:t,userAnswer:n,setUserAnswer:l,score:a,setScore:r,streak:o,setStreak:i,maxStreak:x,setMaxStreak:m,questionCount:c,setQuestionCount:h,correctCount:f,setCorrectCount:j,gameMode:N,setGameMode:w,questionDirection:L,setQuestionDirection:u,questionType:y,setQuestionType:R,isCorrect:$,setIsCorrect:A,showHint:O,setShowHint:b,usedQuestions:U,setUsedQuestions:S,gameStarted:C,setGameStarted:v,showResult:V,setShowResult:M,comboMultiplier:W,setComboMultiplier:D,speedBonus:k,setSpeedBonus:G,maxQuestions:J,setMaxQuestions:H,options:Z,setOptions:P,selectedChoice:K,setSelectedChoice:F,wrongAnswers:X,setWrongAnswers:I,currentVocabularyData:Q,setCurrentVocabularyData:q,startGame:(Y="normal")=>{w(Y),v(!0),M(!1),t(null),l(""),r(0),i(0),m(0),h(0),j(0),A(null),b(!1),S([]),I([]),D(1),G(0),P([]),F(null)},resetGame:()=>{v(!1),M(!1),t(null),l(""),r(0),i(0),m(0),h(0),j(0),A(null),b(!1),S([]),I([]),D(1),G(0),P([]),F(null)}}},Oe=(s,t,n,l,a)=>{const[r,o]=d.useState(30),i=d.useRef(null);return d.useEffect(()=>(s&&!t&&n&&r>0?i.current=setTimeout(()=>{o(m=>m-1)},1e3):r===0&&n&&a(),()=>clearTimeout(i.current)),[r,s,t,n,a]),{timeLeft:r,setTimeLeft:o,resetTimer:()=>{o(l==="speed"?15:30)}}},De=async(s,t="Shift_JIS")=>{if(!s.name.endsWith(".csv"))throw new Error("CSVファイルを選択してください");const l=(await new Promise((r,o)=>{const i=new FileReader;i.onload=x=>r(x.target.result),i.onerror=x=>o(x),i.readAsText(s,t)})).split(`
`).filter(r=>r.trim()),a=[];for(let r=1;r<l.length;r++){const o=l[r].trim();if(!o)continue;const[i,x,m,c]=o.split(",").map(j=>j?j.trim():"");if(!i||!x)throw new Error(`${r+1}行目のフォーマットが正しくありません（英単語と日本語は必須）`);let h="basic";i.length>8||/[A-Z].*[A-Z]/.test(i)?h="advanced":i.length>5&&(h="intermediate");const f=`${i.charAt(0).toLowerCase()} から始まる${i.length}文字の単語`;a.push({english:i.toLowerCase(),japanese:x,example:m||"",example_jp:c||"",difficulty:h,hint:f})}if(a.length===0)throw new Error("有効な単語データが見つかりませんでした");return a},Fe=()=>{const[s,t]=d.useState(ae),[n,l]=d.useState(""),[a,r]=d.useState(!1),[o,i]=d.useState(""),[x,m]=d.useState("Shift_JIS");return{currentVocabularyData:s,uploadedFileName:n,isUploading:a,uploadError:o,encoding:x,setEncoding:m,handleFileUpload:async f=>{if(f){r(!0),i("");try{const j=await De(f,x);t(j),l(f.name),r(!1)}catch(j){i(j.message),r(!1)}}},resetToDefaultData:()=>{t(ae),l(""),i(""),m("Shift_JIS")}}},pe=(s,t)=>{if(!s)return"";const n=new RegExp(`\\b${t}\\b`,"gi"),l=t.length,a="_".repeat(Math.max(3,Math.min(l,8)));return s.replace(n,`(${a})`)},Ue=(s,t,n,l,a,r,o)=>{let i=s;t.difficulty==="intermediate"&&(i+=5),t.difficulty==="advanced"&&(i+=10);const m=Math.max(0,Math.floor(l/(n==="speed"?15:30)*20));return i+=m,i*=o,a||(i+=5),r==="writing"&&(i+=5),{totalPoints:i,speedBonus:m}},ge=s=>{switch(s){case"basic":return"text-green-600 bg-green-100";case"intermediate":return"text-yellow-600 bg-yellow-100";case"advanced":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},Ve=(s,t)=>{const n=t.filter(l=>l.english!==s.english).sort(()=>Math.random()-.5).slice(0,3);return[s,...n].sort(()=>Math.random()-.5)},Ge=(s,t,n)=>n==="en-to-jp"?s.trim()===t:s.trim().toLowerCase()===t.toLowerCase(),Pe=({uploadedFileName:s,isUploading:t,uploadError:n,encoding:l,setEncoding:a,onFileUpload:r,onResetToDefault:o})=>{const i=d.useRef(null),x=c=>{const h=c.target.files[0];h&&r(h)},m=()=>{o(),i.current&&(i.current.value="")};return e.jsxs("div",{className:"mb-8 p-6 bg-gray-50 rounded-2xl",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center justify-center gap-2",children:[e.jsx(de,{className:"w-5 h-5"}),"CSVファイルから単語を読み込み"]}),s?e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"bg-green-100 border border-green-200 rounded-lg p-3 mb-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-800",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:s})]})}),e.jsx("button",{onClick:m,className:"text-sm text-gray-600 hover:text-gray-800 underline",children:"デフォルトデータに戻す"})]}):e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"文字エンコード"}),e.jsxs("select",{value:l,onChange:c=>a(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-indigo-500 text-sm",children:[e.jsx("option",{value:"Shift_JIS",children:"Shift_JIS"}),e.jsx("option",{value:"UTF-8",children:"UTF-8"}),e.jsx("option",{value:"EUC-JP",children:"EUC-JP"})]})]}),e.jsx("input",{ref:i,type:"file",accept:".csv",onChange:x,disabled:t,className:"hidden",id:"csv-upload"}),e.jsx("label",{htmlFor:"csv-upload",className:`block w-full p-4 border-2 border-dashed rounded-lg cursor-pointer transition-all duration-200 ${t?"border-gray-300 bg-gray-100 cursor-not-allowed":"border-indigo-300 hover:border-indigo-500 hover:bg-indigo-50"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(de,{className:`w-6 h-6 ${t?"text-gray-400":"text-indigo-500"}`}),e.jsx("span",{className:`text-sm ${t?"text-gray-400":"text-gray-700"}`,children:t?"読み込み中...":"CSVファイルを選択"})]})}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2 space-y-1",children:[e.jsx("p",{children:"フォーマット: 英単語,日本語,例文,例文の日本語訳"}),e.jsx("p",{children:"3列目・4列目は例文モード用（省略可）"}),e.jsx("p",{children:"1行目はヘッダー行として自動スキップされます"}),e.jsx("p",{children:"推奨エンコード: Shift_JIS (日本語Excel標準)"})]})]}),n&&e.jsx("div",{className:"bg-red-100 border border-red-200 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[e.jsx(Ne,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:n})]})})]})},Ie=({questionDirection:s,setQuestionDirection:t,questionType:n,setQuestionType:l,maxQuestions:a,setMaxQuestions:r,currentVocabularyData:o,onStartGame:i,uploadedFileName:x,isUploading:m,uploadError:c,encoding:h,setEncoding:f,onFileUpload:j,onResetToDefault:N})=>e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl p-8 max-w-lg w-full text-center",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx(xe,{className:"w-20 h-20 mx-auto text-indigo-600 mb-4"}),e.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-yellow-400 rounded-full flex items-center justify-center",children:e.jsx(te,{className:"w-4 h-4 text-yellow-800"})})]}),e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-2",children:"英語学習ゲーム"}),e.jsx("p",{className:"text-gray-600",children:"多彩な学習モードで楽しく英語をマスター！"})]}),e.jsx(Pe,{uploadedFileName:x,isUploading:m,uploadError:c,encoding:h,setEncoding:f,onFileUpload:j,onResetToDefault:N}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"ゲーム設定"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"出題方向"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx("button",{onClick:()=>t("jp-to-en"),className:`py-3 px-4 rounded-lg text-sm font-medium transition-all duration-200 ${s==="jp-to-en"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"日本語 → 英語"}),e.jsx("button",{onClick:()=>t("en-to-jp"),className:`py-3 px-4 rounded-lg text-sm font-medium transition-all duration-200 ${s==="en-to-jp"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"英語 → 日本語"}),e.jsxs("button",{onClick:()=>t("example-to-en"),className:`py-3 px-4 rounded-lg text-sm font-medium transition-all duration-200 ${s==="example-to-en"?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["例文 → 英単語",e.jsx("div",{className:"text-xs mt-1 opacity-80",children:"銀のフレーズ式"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"問題形式"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>l("writing"),className:`py-3 px-4 rounded-lg text-sm font-medium transition-all duration-200 ${n==="writing"?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[s==="jp-to-en"?"英作文":s==="en-to-jp"?"日本語入力":"穴埋め入力",e.jsx("div",{className:"text-xs mt-1 opacity-80",children:"+5pt ボーナス"})]}),e.jsxs("button",{onClick:()=>l("choice"),className:`py-3 px-4 rounded-lg text-sm font-medium transition-all duration-200 ${n==="choice"?"bg-orange-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["4択問題",e.jsx("div",{className:"text-xs mt-1 opacity-80",children:"スピーディー"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"問題数"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[5,10,20,0].map(w=>e.jsx("button",{onClick:()=>r(w),className:`py-2 px-3 rounded-lg text-sm font-medium transition-all duration-200 ${a===w?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:w===0?"全問":`${w}問`},w))})]})]}),e.jsxs("div",{className:"mb-8 grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-lg p-3",children:[e.jsx("div",{className:"font-bold text-lg",children:o.length}),e.jsx("div",{children:"収録単語"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-400 to-pink-500 text-white rounded-lg p-3",children:[e.jsx("div",{className:"font-bold text-lg",children:a===0?o.length:Math.min(a,o.length)}),e.jsx("div",{children:"出題予定"})]})]}),e.jsxs("div",{className:"space-y-3 mb-8",children:[e.jsxs("button",{onClick:()=>i("normal"),className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-4 px-6 rounded-xl font-semibold hover:from-indigo-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5"}),"ノーマルモード"]}),e.jsx("div",{className:"text-xs opacity-90 mt-1",children:"30秒でじっくり考える"})]}),e.jsxs("button",{onClick:()=>i("speed"),className:"w-full bg-gradient-to-r from-orange-500 to-red-600 text-white py-4 px-6 rounded-xl font-semibold hover:from-orange-600 hover:to-red-700 transition-all duration-300 transform hover:scale-105 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(te,{className:"w-5 h-5"}),"スピードモード"]}),e.jsx("div",{className:"text-xs opacity-90 mt-1",children:"15秒の高速回答"})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[e.jsx("p",{children:"💡 ヒント機能で学習サポート"}),e.jsx("p",{children:"🔥 連続正解でコンボボーナス"}),e.jsx("p",{children:"⚡ 速答でスピードボーナス"}),e.jsx("p",{children:"✍️ 英作文でさらにボーナス"})]})]})}),Be=({questionDirection:s,gameMode:t,questionType:n,questionCount:l,maxQuestions:a,currentVocabularyData:r,score:o,streak:i,comboMultiplier:x,correctCount:m,timeLeft:c,onResetGame:h})=>{const f=()=>{switch(s){case"jp-to-en":return"日→英";case"en-to-jp":return"英→日";case"example-to-en":return"例文→英";default:return""}},j=()=>{if(n==="writing")switch(s){case"jp-to-en":return"英作文";case"en-to-jp":return"日本語";case"example-to-en":return"穴埋め";default:return"記述"}return"4択"},N=()=>{switch(s){case"jp-to-en":return"英作文チャレンジ";case"en-to-jp":return"英語学習クイズ";case"example-to-en":return"例文穴埋めクイズ";default:return"英語学習ゲーム"}};return e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl shadow-xl p-4 mb-6 border border-white/20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:N()}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"bg-yellow-500 text-white px-2 py-1 rounded-full text-xs",children:t==="speed"?"SPEED":"NORMAL"}),e.jsx("div",{className:"bg-purple-500 text-white px-2 py-1 rounded-full text-xs",children:f()}),e.jsx("div",{className:"bg-green-500 text-white px-2 py-1 rounded-full text-xs",children:j()})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-white font-bold text-lg",children:["第",Math.min(l+1,a===0?r.length:a),"問 / 全",a===0?r.length:a,"問"]}),e.jsx("button",{onClick:h,className:"text-white/70 hover:text-white transition-colors",children:e.jsx(me,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:o.toLocaleString()}),e.jsx("div",{className:"text-xs text-white/70",children:"スコア"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-400 flex items-center justify-center gap-1",children:[i,i>=5&&e.jsx(te,{className:"w-4 h-4"})]}),e.jsx("div",{className:"text-xs text-white/70",children:"連続正解"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400",children:x>1?`×${x}`:"×1"}),e.jsx("div",{className:"text-xs text-white/70",children:"コンボ"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[m,"/",l]}),e.jsx("div",{className:"text-xs text-white/70",children:"正解率"})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 mb-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-2xl font-bold ${c<=5?"text-red-400 animate-pulse":"text-blue-400"}`,children:c}),e.jsx("div",{className:"text-xs text-white/70",children:"残り時間"})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-xs text-white/70 mb-1",children:[e.jsx("span",{children:"進度"}),e.jsxs("span",{children:[Math.min(l,a===0?r.length:a),"/",a===0?r.length:a]})]}),e.jsx("div",{className:"w-full bg-white/20 rounded-full h-2",children:e.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(100,l/(a===0?r.length:a)*100)}%`}})})]})]})},Je=({currentQuestion:s,questionDirection:t,questionType:n,userAnswer:l,setUserAnswer:a,options:r,selectedChoice:o,onSelectChoice:i,onCheckAnswer:x,showHint:m,setShowHint:c,isCorrect:h,timeLeft:f,speedBonus:j,comboMultiplier:N,streak:w,onGoToNextQuestion:L})=>{const u=d.useRef(null);if(d.useEffect(()=>{n==="writing"&&u.current&&setTimeout(()=>{u.current.focus()},100)},[s,n]),!s)return null;const y=()=>{switch(t){case"jp-to-en":return s.japanese;case"en-to-jp":return s.english;case"example-to-en":return pe(s.example,s.english);default:return""}},R=()=>{switch(t){case"jp-to-en":return n==="writing"?"英語で答えてください":"英語を選択してください";case"en-to-jp":return n==="writing"?"日本語で答えてください":"日本語を選択してください";case"example-to-en":return n==="writing"?"空欄に入る英単語を答えてください":"空欄に入る英単語を選択してください";default:return""}},$=()=>{switch(t){case"jp-to-en":return"英単語を入力...";case"en-to-jp":return"日本語を入力...";case"example-to-en":return"空欄に入る英単語を入力...";default:return""}},A=()=>{switch(t){case"jp-to-en":return s.hint;case"en-to-jp":return`「${s.english}」の意味は「${s.japanese}」`;case"example-to-en":return`空欄は${s.english.length}文字の単語です`;default:return""}},O=()=>{switch(t){case"jp-to-en":case"example-to-en":return s.english;case"en-to-jp":return s.japanese;default:return""}};return e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 mb-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-50 to-purple-50 opacity-50"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6",children:[e.jsx("div",{className:`px-4 py-2 rounded-full text-sm font-medium ${ge(s.difficulty)}`,children:s.difficulty}),N>1&&e.jsxs("div",{className:"bg-gradient-to-r from-orange-400 to-red-500 text-white px-3 py-1 rounded-full text-sm font-bold",children:[N,"× COMBO!"]})]}),e.jsx("h2",{className:"text-4xl font-bold text-gray-800 mb-4",children:y()}),e.jsx("p",{className:"text-gray-600 text-lg",children:R()}),t==="example-to-en"&&e.jsxs("div",{className:"mt-4 space-y-3",children:[s.example_jp&&e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-blue-800 text-sm",children:["🇯🇵 ",e.jsx("span",{className:"font-medium",children:"例文訳:"})," ",s.example_jp]})}),e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("p",{className:"text-green-800 text-sm",children:["💡 ",e.jsx("span",{className:"font-medium",children:"空欄の単語の意味:"})," ",s.japanese]})})]})]}),n==="writing"?e.jsx("div",{className:"max-w-md mx-auto mb-6",children:e.jsx("input",{ref:u,type:"text",value:l,onChange:b=>a(b.target.value),onKeyDown:b=>{b.key==="Enter"&&l.trim()!==""&&h===null&&x()},placeholder:$(),disabled:h!==null,className:"w-full p-4 text-xl text-center border-2 border-gray-300 rounded-xl focus:border-indigo-500 focus:outline-none transition-all duration-200 bg-white shadow-inner"})}):e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"grid grid-cols-1 gap-3 max-w-2xl mx-auto",children:r.map((b,U)=>{const S=t==="jp-to-en"||t==="example-to-en"?b.english:b.japanese,C=t==="jp-to-en"||t==="example-to-en"?b.english===s.english:b.japanese===s.japanese;let v="w-full p-4 text-left rounded-lg border-2 transition-all duration-200 transform hover:scale-102";return o===null?v+=" border-gray-200 hover:border-indigo-300 hover:bg-indigo-50":C?v+=" border-green-500 bg-green-50 text-green-700":b===o?v+=" border-red-500 bg-red-50 text-red-700":v+=" border-gray-200 bg-gray-50 text-gray-500",e.jsx("button",{onClick:()=>i(b),className:v,disabled:o!==null,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-lg",children:S}),o!==null&&C&&e.jsx("div",{className:"text-green-600 text-xl",children:"✓"}),o===b&&!C&&e.jsx("div",{className:"text-red-600 text-xl",children:"✗"})]})},U)})})}),e.jsx("div",{className:"flex justify-center gap-4 mb-6",children:h===null?e.jsxs(e.Fragment,{children:[n==="writing"&&e.jsx("button",{onClick:x,disabled:l.trim()==="",className:"bg-indigo-600 text-white px-8 py-3 rounded-xl font-semibold hover:bg-indigo-700 transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:transform-none shadow-lg",children:"回答する"}),!m&&e.jsxs("button",{onClick:()=>c(!0),className:"bg-yellow-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-yellow-600 transition-all duration-200 transform hover:scale-105 shadow-lg flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"}),"ヒント"]})]}):e.jsxs("button",{onClick:L,className:"bg-green-600 text-white px-8 py-3 rounded-xl font-semibold hover:bg-green-700 transition-all duration-200 transform hover:scale-105 shadow-lg flex items-center gap-2",children:["次の問題へ",e.jsx(ne,{className:"w-4 h-4"})]})}),m&&n==="writing"&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-6 text-center",children:e.jsxs("div",{className:"text-yellow-800",children:["💡 ",A()]})}),h!==null&&e.jsxs("div",{className:`p-6 rounded-xl text-center ${h?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[e.jsxs("div",{className:`flex items-center justify-center gap-2 text-xl font-bold mb-2 ${h?"text-green-800":"text-red-800"}`,children:[h?e.jsx(Se,{className:"w-6 h-6"}):e.jsx(Ce,{className:"w-6 h-6"}),h?"正解！":f===0?"タイムアップ！":"不正解"]}),e.jsxs("div",{className:"text-gray-700 mb-2",children:["正解: ",e.jsx("span",{className:"font-bold text-lg",children:O()})]}),h&&e.jsxs("div",{className:"space-y-1 text-sm text-green-700",children:[j>0&&e.jsxs("div",{children:["⚡ スピードボーナス: +",j,"pt"]}),!m&&e.jsx("div",{children:"💡 ヒント未使用ボーナス: +5pt"}),n==="writing"&&e.jsx("div",{children:"✍️ 英作文ボーナス: +5pt"}),N>1&&e.jsxs("div",{children:["🔥 コンボボーナス: ×",N]}),w>=5&&e.jsx("div",{children:"🔥 連続正解ボーナス!"})]}),e.jsx("div",{className:"text-sm text-gray-600 mt-3",children:n==="writing"?"Enterキーでも次に進めます":"選択肢をクリックして回答"})]})]})]})},He=({score:s,questionCount:t,correctCount:n,maxStreak:l,wrongAnswers:a,gameMode:r,onResetGame:o,onStartGame:i})=>{const x=t>0?Math.round(n/t*100):0,m=t>0?Math.round(s/t):0;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-yellow-400 via-orange-500 to-red-600 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl p-8 max-w-lg w-full text-center",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(ke,{className:"w-20 h-20 mx-auto text-yellow-500 mb-4"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:a.length===0?"🎉 パーフェクト！":"ゲーム終了！"}),e.jsx("div",{className:"text-lg text-gray-600",children:"お疲れさまでした！"})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl p-6",children:[e.jsx("div",{className:"text-4xl font-bold",children:s.toLocaleString()}),e.jsx("div",{className:"text-sm opacity-90",children:"総スコア"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[x,"%"]}),e.jsx("div",{className:"text-xs text-green-500",children:"正答率"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:l}),e.jsx("div",{className:"text-xs text-orange-500",children:"最大連続正解"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[e.jsxs("div",{className:"bg-blue-50 rounded p-2",children:[e.jsx("div",{className:"font-bold text-blue-600",children:n}),e.jsx("div",{className:"text-xs text-blue-500",children:"正解数"})]}),e.jsxs("div",{className:"bg-purple-50 rounded p-2",children:[e.jsx("div",{className:"font-bold text-purple-600",children:t}),e.jsx("div",{className:"text-xs text-purple-500",children:"総問題数"})]}),e.jsxs("div",{className:"bg-pink-50 rounded p-2",children:[e.jsx("div",{className:"font-bold text-pink-600",children:m}),e.jsx("div",{className:"text-xs text-pink-500",children:"平均得点"})]})]}),a.length===0&&n===t&&e.jsx("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(_e,{className:"w-5 h-5"}),e.jsx("span",{className:"font-bold",children:"パーフェクトボーナス +500pt!"})]})})]}),a.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5"}),"復習用：間違えた単語 (",a.length,"個)"]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 max-h-60 overflow-y-auto",children:e.jsx("div",{className:"space-y-3",children:a.map((c,h)=>e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-red-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"text-lg font-bold text-gray-800",children:c.questionDirection==="jp-to-en"?c.word.japanese:c.questionDirection==="en-to-jp"?c.word.english:pe(c.word.example,c.word.english)}),e.jsx("div",{className:`px-2 py-1 rounded text-xs ${ge(c.word.difficulty)}`,children:c.word.difficulty})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-green-600 font-medium",children:"正解:"}),e.jsx("span",{className:"text-green-700 font-bold",children:c.correctAnswer})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-red-600 font-medium",children:"あなたの回答:"}),e.jsx("span",{className:"text-red-700",children:c.userAnswer})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[c.questionDirection==="jp-to-en"?"日→英":c.questionDirection==="en-to-jp"?"英→日":"例文→英"," ·",c.questionType==="writing"?" 記述式":" 4択"]})]})]},h))})}),e.jsx("div",{className:"text-xs text-gray-500 mt-2 text-center",children:"💡 これらの単語を重点的に復習しましょう"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:o,className:"bg-gray-600 text-white py-3 px-4 rounded-xl font-semibold hover:bg-gray-700 transition-all duration-200 flex items-center justify-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"モード選択"]}),e.jsxs("button",{onClick:()=>i(r),className:"bg-indigo-600 text-white py-3 px-4 rounded-xl font-semibold hover:bg-indigo-700 transition-all duration-200 flex items-center justify-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),"同じモード"]})]})]})})},Ze=()=>{const s=Me(),t=Fe(),{currentQuestion:n,setCurrentQuestion:l,userAnswer:a,setUserAnswer:r,score:o,setScore:i,streak:x,setStreak:m,maxStreak:c,setMaxStreak:h,questionCount:f,setQuestionCount:j,correctCount:N,setCorrectCount:w,gameMode:L,questionDirection:u,questionType:y,isCorrect:R,setIsCorrect:$,showHint:A,setShowHint:O,usedQuestions:b,setUsedQuestions:U,gameStarted:S,showResult:C,setShowResult:v,comboMultiplier:V,setComboMultiplier:M,speedBonus:W,setSpeedBonus:D,maxQuestions:k,options:G,setOptions:J,selectedChoice:H,setSelectedChoice:Z,wrongAnswers:P,setWrongAnswers:K,startGame:F,resetGame:X,setQuestionDirection:I,setQuestionType:Q,setMaxQuestions:q}=s,B=Oe(S,C,n,L,()=>{$(!1),m(0),M(1);const p=f+1;if(j(p),n){const _={word:n,userAnswer:"タイムアウト",correctAnswer:u==="jp-to-en"||u==="example-to-en"?n.english:n.japanese,questionType:y,questionDirection:u};K(T=>[...T,_])}const g=k===0?t.currentVocabularyData.length:k;p>=g&&setTimeout(()=>{v(!0)},1500)}),Y=(p=!1)=>{if(!p){const T=k===0?t.currentVocabularyData.length:k;if(f>=T){v(!0);return}}let g=t.currentVocabularyData.filter(T=>!b.includes(T.english));if(u==="example-to-en"&&(g=g.filter(T=>T.example&&T.example.trim()!==""),g.length===0)){alert("例文モード用のデータが不足しています。CSVファイルの3列目に例文を追加してください。");return}if(g.length===0){v(!0);return}const _=g[Math.floor(Math.random()*g.length)];l(_),U(T=>[...T,_.english]),r(""),$(null),O(!1),Z(null),B.resetTimer(),D(0),J(y==="choice"?Ve(_,t.currentVocabularyData):[])},re=(p,g=null)=>{if($(p),p){const{totalPoints:oe,speedBonus:ee}=Ue(10,n,L,B.timeLeft,A,y,V);D(ee),i(E=>E+oe),m(E=>E+1),h(E=>Math.max(E,x+1)),w(E=>E+1),x>=4&&M(E=>Math.min(E+.5,3))}else{m(0),M(1);const ee={word:n,userAnswer:g||(y==="writing"?a:"未回答"),correctAnswer:u==="jp-to-en"||u==="example-to-en"?n.english:n.japanese,questionType:y,questionDirection:u};K(E=>[...E,ee])}const _=f+1;j(_);const T=k===0?t.currentVocabularyData.length:k;_>=T&&setTimeout(()=>{v(!0)},1500)},le=()=>{if(!n||a.trim()==="")return;const p=a.trim().toLowerCase();let g;u==="jp-to-en"?g=n.english.toLowerCase():u==="en-to-jp"?g=n.japanese:u==="example-to-en"&&(g=n.english.toLowerCase());const _=Ge(p,g,u);re(_,p)},je=p=>{if(H!==null)return;Z(p);let g;u==="jp-to-en"||u==="example-to-en"?g=p.english===n.english:u==="en-to-jp"&&(g=p.japanese===n.japanese);const _=u==="jp-to-en"||u==="example-to-en"?p.english:p.japanese;re(g,_)},ie=()=>{const p=k===0?t.currentVocabularyData.length:k;if(f>=p){v(!0);return}Y()};return d.useEffect(()=>{const p=g=>{!S||C||g.key==="Enter"&&(R===null&&y==="writing"&&a.trim()!==""?le():R!==null&&ie())};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[S,C,R,y,a]),d.useEffect(()=>{S&&!C&&b.length===0&&!n&&Y(!0)},[S,C,b,n]),d.useEffect(()=>{s.setCurrentVocabularyData(t.currentVocabularyData)},[t.currentVocabularyData]),S?C?e.jsx(He,{score:o,questionCount:f,correctCount:N,maxStreak:c,wrongAnswers:P,gameMode:L,onResetGame:X,onStartGame:F}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx(Be,{questionDirection:u,gameMode:L,questionType:y,questionCount:f,maxQuestions:k,currentVocabularyData:t.currentVocabularyData,score:o,streak:x,comboMultiplier:V,correctCount:N,timeLeft:B.timeLeft,onResetGame:X}),e.jsx(Je,{currentQuestion:n,questionDirection:u,questionType:y,userAnswer:a,setUserAnswer:r,options:G,selectedChoice:H,onSelectChoice:je,onCheckAnswer:le,showHint:A,setShowHint:O,isCorrect:R,timeLeft:B.timeLeft,speedBonus:W,comboMultiplier:V,streak:x,onGoToNextQuestion:ie})]})}):e.jsx(Ie,{questionDirection:u,setQuestionDirection:I,questionType:y,setQuestionType:Q,maxQuestions:k,setMaxQuestions:q,currentVocabularyData:t.currentVocabularyData,onStartGame:F,uploadedFileName:t.uploadedFileName,isUploading:t.isUploading,uploadError:t.uploadError,encoding:t.encoding,setEncoding:t.setEncoding,onFileUpload:t.handleFileUpload,onResetToDefault:t.resetToDefaultData})};se.createRoot(document.getElementById("root")).render(e.jsx(ve.StrictMode,{children:e.jsx(Ze,{})}));
